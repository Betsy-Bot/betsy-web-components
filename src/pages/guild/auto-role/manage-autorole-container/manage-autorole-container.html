<template>
    <div class="row g-4">
        <div class="col-12 col-xl-8">
            <discord-feature-header
                doc-url="https://docs.betsybot.xyz/features/auto-role"
                title="Auto Role Containers"
                subtitle="Create a message with a select menu allowing users to select roles they want to be added to for your server."
            ></discord-feature-header>
            <div class="my-1">
                <div class="mt-1 mb-3 text-danger fs-7 d-inline-flex align-content-center">
                            <span class="material-icons me-2">
                                warning
                            </span>
                    In order for the bot to add or remove a specific role it MUST be above it in the role list. If you do not have the Betsy role above the roles selected it will NOT remove/add those roles.
                </div>
            </div>
            <div class="mt-4">
                <form submit.delegate="putContainer()">
                    <div class="col-12 my-3">
                        <button
                            mdc-switch
                            selected.bind="container.active"
                            value.bind="container.active"
                            change.delegate="container.active = !!responder.active"
                        ></button>
                        <label class="me-5">Active?</label>
                    </div>

                    <div class="mb-3">
                        <mdc-tab-bar
                            view-model.ref="tabBar"
                            use-automatic-activation.bind="useAutomaticActivation"
                            focus-on-activate.bind="false"
                        >
                            <mdc-tab label="Container" active.bind="tab === 'container'"
                                     click.delegate="tab = 'container'"></mdc-tab>
                            <mdc-tab label="Roles" active.bind="tab === 'roles'"
                                     click.delegate="tab = 'roles'"></mdc-tab>
                        </mdc-tab-bar>
                    </div>

                    <section if.bind="tab === 'container'">
                        <mdc-text-field
                            label="Identifier"
                            class="w-100 my-2"
                            placeholder="Container Identifier"
                            value.bind="container.name"
                            required
                        ></mdc-text-field>
                        <mdc-text-field
                            label="Description"
                            class="w-100 mb-2"
                            placeholder="Container Description"
                            value.bind="container.description"
                        ></mdc-text-field>
                        <discord-channel-selector
                            required.bind="true"
                            label="Select Channel for Container"
                            type.bind="0"
                            channel-id.two-way="container.discordMessage.discordChannelId"
                        ></discord-channel-selector>

                        <discord-message-creator
                            message.two-way="container.discordMessage.message"
                        ></discord-message-creator>

                        <div class="mt-3 text-end">
                            <button mdc-button class="button-primary" type="button" click.delegate="tab = 'roles'">
                                Next
                            </button>
                        </div>
                    </section>

                    <section if.bind="tab === 'roles'">
                        <discord-role-selector
                            remove-everyone.bind="true"
                            label="Select Roles"
                            selected-role.two-way="selectedRole"
                        ></discord-role-selector>

                        <div class="row g-4 mt-2" if.bind="container.discordRoles">
                            <div class="col-12 col-lg-6" repeat.for="role of container.discordRoles">
                                <discord-menu-item item.two-way="role" remove-function.call="removeRole($index)"></discord-menu-item>
                            </div>
                        </div>

                        <div class="mt-3 text-end">
                            <button mdc-button class="button-primary" type="submit">
                                ${isNew ? 'Create' : 'Save'}
                            </button>
                        </div>
                    </section>
                </form>
            </div>
        </div>
        <div class="col-12 col-xl-4">
            <discord-message-preview message.bind="container.discordMessage.message"></discord-message-preview>
        </div>
    </div>
</template>
