<template>
    <confirmation-dialog
        cancel-text="Cancel"
        confirm-text="Delete"
        dialog.two-way="confirmDeleteDialog"
        handler.bind="(event) => deleteItem(event)"
        title="Are you sure you would like to delete?"
    >
        This is a permanent action and cannot be undone
    </confirmation-dialog>
    <section id="create-data-command">
        <div class="row">
            <div class="col-12 col-lg-8">
                <feature-header
                    doc-url="https://docs.betsybot.xyz/features/tracked-messages"
                    title="${isNew ? 'Create' : 'Edit'} Tracked Message"
                    subtitle="Tracked Messages are just normal messages that you keep track of. This allows you to edit them without resending/using a command/etc."
                    delete-function.bind="() => confirmDeleteDialog.open()"
                    copy-function.bind="() => copy()"
                ></feature-header>

                <form submit.trigger="save()">
                    <div class="row my-2 g-4">
                        <div class="col-12 h-100">
                            <label class="me-3">Active?</label>
                            <moo-switch
                                value.bind="message.discordMessage.active"
                            ></moo-switch>
                        </div>
                        <div class="col-12 col-lg-6 h-100">
                            <moo-text-field
                                class="w-100"
                                label="Name"
                                value.bind="message.name"
                                placeholder="Internal Identifier - Not used in message"
                                required.bind="true"
                            ></moo-text-field>
                        </div>
                        <div class="col-12 col-lg-6 h-100">
                            <moo-text-field
                                class="w-100"
                                label="Time to Resend (Minutes)"
                                value.bind="message.timeToResend"
                                placeholder="Time, in minutes, to resend message after"
                            ></moo-text-field>
                        </div>
                        <div class="col-12 h-100">
                            <discord-channel-selector
                                label="Select Channel"
                                if.bind="guildId"
                                channel-id.two-way="message.discordMessage.discordChannelId"
                                guild-id.bind="guildId"
                                type.bind="0"
                                required.bind="true"
                            ></discord-channel-selector>
                        </div>
                    </div>

                    <discord-message-creator
                        message.two-way="message.discordMessage.message"
                        allow-components.bind="true"
                        max-components.bind="5"
                    ></discord-message-creator>

                    <div class="text-end mt-3">
                        <moo-button variant="primary" type="submit">
                            Save
                        </moo-button>
                    </div>
                </form>
            </div>
            <div class="col-12 col-lg-4">
                <discord-message-preview message.two-way="message.discordMessage.message"></discord-message-preview>
            </div>
        </div>
    </section>
</template>
