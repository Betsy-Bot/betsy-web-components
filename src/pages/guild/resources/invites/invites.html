<feature-header
    doc-url="https://docs.betsybot.xyz/features/invites"
    title="Invites"
    subtitle="Track invites created by your users and provide benefits to them such as roles for achieving milestones.
            Activate the feature to view your invites"
    include-toggle.bind="true"
    toggle-function.bind="() => toggleFeature()"
    feature-active.bind="featureActive"
></feature-header>

<moo-tab-bar class="my-3">
    <moo-tab
        label="Invite Links"
        tab.bind="tab"
        value="links"
        active.bind="tab === 'links'"
    ></moo-tab>
    <moo-tab
        label="User Invites"
        tab.bind="tab"
        value="user-invites"
        active.bind="tab === 'user-invites'"
    ></moo-tab>
    <moo-tab
        label="Invite Roles"
        tab.bind="tab"
        value="roles"
        active.bind="tab === 'roles'"
    ></moo-tab>
    <moo-tab
        label="Invite Settings"
        tab.bind="tab"
        value="settings"
        active.bind="tab === 'settings'"
    ></moo-tab>
</moo-tab-bar>

<moo-data-grid
    if.bind="tab === 'links' && invites && inviteColumns"
    items.bind="invites"
    columns.bind="inviteColumns"
    summary.bind="gridSummary"
></moo-data-grid>

<moo-data-grid
    if.bind="tab === 'user-invites' && guildUserInvites && guildUserInvitesColumns"
    items.bind="guildUserInvites"
    columns.bind="guildUserInvitesColumns"
></moo-data-grid>

<confirmation-dialog
    cancel-text="Cancel"
    confirm-text="Create"
    dialog.two-way="createInviteRole"
    handler.bind="(event) => handleCreateDialog(event)"
    title="Create new Invite Role"
>
    <discord-role-selector
        label="Select Role"
        selected-role.two-way="newInviteRole.roleId"
    ></discord-role-selector>
    <moo-text-field
        type="number"
        class="w-100 mt-2"
        label="Invite Count"
        value.bind="newInviteRole.count"
    ></moo-text-field>
</confirmation-dialog>

<template if.bind="tab === 'roles'">
    <moo-button variant="primary" click.bind="() => createInviteRole.open()" type="button">
        Create New Invite Role
    </moo-button>
    <div class="row my-3">
        <div class="col-12 col-xl-6 p-3" repeat.for="inviteRole of guild.inviteSettings.inviteRoles">
            <div elevation="9" class="p-3 position-relative">
                <div promise.bind="inviteRole.discordRoleId | discordRole">
                    <let data.bind="null" err.bind="null"></let>
                    <span then.from-view="data">
                        Role: ${data}
                    </span>
                </div>
                <div>
                    Count: ${inviteRole.count}
                </div>
                <moo-fab
                    class="redFab topRight position-absolute top-0 end-0"
                    icon="delete"
                    click.bind="() => removeRole($index)"
                ></moo-fab>
            </div>
        </div>
    </div>
    <div class="text-end">
        <moo-button variant="primary" click.bind="() => saveRoles()" type="button">
            Save
        </moo-button>
    </div>
</template>

<template if.bind="tab === 'settings'">
    <h4>Minimum Account Age Settings</h4>
</template>
