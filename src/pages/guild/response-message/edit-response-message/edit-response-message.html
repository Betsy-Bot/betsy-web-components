<template>
    <confirmation-dialog
        cancel-text="Cancel"
        confirm-text="Delete"
        dialog.two-way="confirmDeleteDialog"
        handler.call="deleteCommand(event)"
        title="Are you sure you would like to delete?"
    >
        This is a permanent action and cannot be undone
    </confirmation-dialog>
    <div class="row">
        <div class="col-8">
            <div class="row">
                <div class="col-9">
                    <h3 class="mb-3">
                        Editing /${command.name}
                    </h3>
                </div>
                <div class="col-3 text-end">
                    <button mdc-button class="button-secondary" click.delegate="confirmDeleteDialog.open()">
                        Delete
                    </button>
                </div>
            </div>

            <div>
                <div class="mt-1 mb-3 text-warning fs-7 d-inline-flex align-content-center">
                <span class="material-icons me-2">
                    warning
                </span>
                    Having more than 1 "Interaction Response" type will result in one action not being responded to. You
                    may
                    only have 1 "Interaction Response" action. Use "Channel Response" for more than 1 action.
                </div>
            </div>

            <discord-command-creator command.two-way="command"></discord-command-creator>

            <div class="my-3" repeat.for="action of command.discordCommandActions">
                <discord-action-creator
                    delete-function.call="deleteAction($index)"
                    action.two-way="action"
                ></discord-action-creator>
            </div>

            <div class="text-end">
                <button mdc-button
                        class="button-primary"
                        if.bind="command.discordCommandActions.length < 10"
                        click.delegate="createNewCommandAction()">
                    Add Action
                </button>
            </div>

            <div class="mt-4">
                <a href="/guild/${guildId}/response-message">
                    <button mdc-button class="button-secondary">
                        Cancel
                    </button>
                </a>
                <button mdc-button
                        class="button-primary ms-4"
                        click.delegate="updateCommand()">
                    Save
                </button>
            </div>
        </div>
        <div class="col-4">
            <div class="my-2" repeat.for="action of command.discordCommandActions">
                <discord-message-preview
                    message.bind="action.discordMessage.message"
                    first.bind="$index === 0"
                ></discord-message-preview>
            </div>
        </div>
    </div>
</template>
