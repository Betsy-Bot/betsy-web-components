<feature-header
    title="Settings"
    subtitle="Manage various global settings for your server"
></feature-header>

<div class="row mt-4 g-4">
    <div class="col-12 col-lg-6" if.bind="isOwner">
        <div class="permission-area p-4" elevation="12">
            <h4>Authorized Owners</h4>
            <span>Add additional owners to server. These users have full control over your server and data.</span>
            <form submit.trigger="addAuthorizedOwner()">
                <div class="row my-2">
                    <div class="col-10">
                        <moo-text-field
                            min="100000000000000000"
                            max="9999999999999999999"
                            type="number"
                            class="w-100"
                            label="Discord ID"
                            placeholder="Enter Discord User ID"
                            value.bind="ownerUserId"
                        ></moo-text-field>
                    </div>
                    <div class="col-2">
                        <moo-button variant="primary" class="w-100 h-100" type="submit">
                            Add
                        </moo-button>
                    </div>
                </div>
                <moo-chip-set input if.bind="guild.authorizedOwners">
                    <!-- Compact notation -->
                    <moo-chip repeat.for="user of guild.authorizedOwners">
                        <template promise.bind="user | discordName">
                            <let data.bind="null" err.bind="null"></let>
                            <span then.from-view="data">
                                    ${data}
                                </span>
                        </template>
                        <span click.trigger="removeOwner($index)" trailing>X</span>
                    </moo-chip>
                </moo-chip-set>
            </form>
        </div>
    </div>
    <div class="col-12 col-lg-6" if.bind="isOwner">
        <div class="permission-area p-4" elevation="12">
            <h4>Authorized Panel Users</h4>
            <span>Add administrators to help manage your server. Authorized users cannot request data transfers.</span>
            <form submit.trigger="addAuthorizedUser()">
                <div class="row my-2">
                    <div class="col-10">
                        <moo-text-field
                            disabled.bind="!isAdmin"
                            min="10000000000000000"
                            max="9999999999999999999"
                            type="number"
                            class="w-100"
                            label="Discord ID"
                            placeholder="Enter Discord User ID"
                            value.bind="permissionUserId"
                        ></moo-text-field>
                    </div>
                    <div class="col-2">
                        <moo-button variant="primary" class="w-100 h-100" type="submit">
                            Add
                        </moo-button>
                    </div>
                </div>
                <moo-chip-set input if.bind="guild.authorizedUsers">
                    <!-- Compact notation -->
                    <moo-chip repeat.for="user of guild.authorizedUsers">
                        <template promise.bind="user | discordName">
                            <let data.bind="null" err.bind="null"></let>
                            <span then.from-view="data">
                                    ${data}
                                </span>
                        </template>
                        <span click.trigger="removeUser($index)" trailing>X</span>
                    </moo-chip>
                </moo-chip-set>
            </form>
        </div>
    </div>
    <div class="col-12 col-lg-6">
        <form submit.trigger="updateAutoRolesSettings()">
            <div class="p-4" elevation="12">
                <h4>Auto Roles</h4>
                <discord-role-selector
                    label="Select Roles"
                    selected-role.two-way="selectedRole"
                ></discord-role-selector>
                <moo-chip-set input if.bind="guild.globalSettings.autoRoles">
                    <!-- Compact notation -->
                    <moo-chip repeat.for="role of guild.globalSettings.autoRoles">
                        ${role.name}
                        <span click.trigger="removeRole($index)" trailing>X</span>
                    </moo-chip>
                </moo-chip-set>
                <div class="text-end mt-3">
                    <moo-button variant="primary" type="submit">
                        Save
                    </moo-button>
                </div>
            </div>
        </form>
    </div>
    <div class="col-12 col-lg-6">
        <form submit.trigger="updateGlobalSettings()">
            <div class="p-4" elevation="12" if.bind="guild">
                <div class="d-flex justify-content-between">
                    <h4 class="d-inline-flex">Custom Bot Settings</h4>
                    <div class="d-inline-flex">
                        <moo-switch
                            value.bind="guild.customBotActive"
                            change.bind="() => toggleCustomBot()"
                        ></moo-switch>
                    </div>
                </div>
                <div class="text-danger fs-6">
                    This feature is for Platinum supporters only. Learn more on our discord.
                </div>
                <moo-text-field
                    type="number"
                    class="w-100 my-2"
                    label="Application Id"
                    placeholder="Discord Application Id"
                    value.bind="guild.customBotApplicationId"
                ></moo-text-field>
                <moo-text-field
                    type="text"
                    class="w-100 my-2"
                    label="Bot Token"
                    placeholder="Custom Bot Token"
                    value.bind="guild.customBotJwtKey"
                ></moo-text-field>
                <moo-text-field
                    type="text"
                    label="Bot Status"
                    class="w-100 my-2"
                    placeholder="Custom Bot Status"
                    value.bind="guild.customBotStatus"
                ></moo-text-field>
                <div class="row mt-3">
                    <div class="col">
                        <a if.bind="guild.customBotActive" load="../global-commands-management">
                            <moo-button variant="secondary" type="button" disabled.bind="!guild.customBotActive">
                                Register Global Commands
                            </moo-button>
                        </a>
                    </div>
                    <div class="col text-end">
                        <moo-button variant="primary" type="submit">
                            Save
                        </moo-button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="col-12 col-lg-6">
        <form submit.trigger="updateConfigurationOwner()">
            <div class="p-4" elevation="12" if.bind="guild">
                <h4 class="d-inline-flex">Update Configuration Owner</h4>
                <moo-text-field
                    disabled.bind="!isOwner"
                    type="number"
                    class="w-100 my-2"
                    label="Change Configuration Owner"
                    placeholder="1234567890"
                    value.bind="newOwnerId"
                ></moo-text-field>
                <div class="text-end mt-3">
                    <moo-button variant="primary" type="submit" disabled.bind="!isOwner">
                        Save
                    </moo-button>
                </div>
            </div>
        </form>
    </div>
</div>
