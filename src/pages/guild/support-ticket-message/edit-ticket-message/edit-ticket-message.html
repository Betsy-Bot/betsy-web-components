<template>
    <section id="support-tickets">
        <div class="row">
            <div class="col-12 col-lg-8">
                <discord-feature-header
                    title="Edit Support Ticket Message"
                    subtitle="Edit the message that is already on your server."
                ></discord-feature-header>

                <div class="row">
                    <div class="col-6">
                        <a href="guild/${guildId}/support-tickets/${discordMessageId}/submissions" mdc-button class="button-primary mt-3 mb-4">
                            View Created Tickets
                        </a>
                    </div>
                    <div class="col-6 text-end">
                        <button mdc-button class="button-secondary" click.delegate="handleClone()">
                            Clone Support Ticket
                        </button>
                    </div>
                </div>

                <mdc-tab-bar view-model.ref="tabBar">
                    <mdc-tab
                        label="Support Ticket Container"
                        active.bind="tab === 'container'"
                        click.delegate="tab = 'container'"></mdc-tab>
                    <mdc-tab
                        label="Ticket Created Message"
                        active.bind="tab === 'initial'"
                        click.delegate="tab = 'initial'"
                    ></mdc-tab>
                </mdc-tab-bar>

                <form submit.delegate="setupSupportTicket()">
                    <div if.bind="tab === 'container'">
                        <div class="fs-6 py-3">Customize the Message Container which is to house the Create Ticket Button</div>
                        <support-ticket-settings
                            guild-id.bind="guildId"
                            request.two-way="message"
                            authorized-role.two-way="authorizedRole"
                        ></support-ticket-settings>

                        <div class="my-3"></div>

                        <discord-message-creator
                            max-components.bind="1"
                            allow-components.bind="true"
                            message.bind="message.message"
                            single.bind="true"
                        ></discord-message-creator>
                    </div>

                    <div if.bind="tab === 'initial'">
                        <div class="fs-6 py-3">Customize the Initial Message that is sent to the channel when the support ticket channel is created</div>
                        <discord-message-creator
                            allow-components.bind="false"
                            message.two-way="message.settings.initialMessage"
                            single.bind="true"
                        ></discord-message-creator>
                    </div>

                    <button mdc-button class="button-primary mt-2" type="submit">
                        Save
                    </button>
                </form>
            </div>
            <div class="col-12 col-lg-4">
                <discord-message-preview message.bind="message.message" if.bind="tab === 'container'"></discord-message-preview>
                <discord-message-preview message.bind="message.settings.initialMessage" if.bind="tab === 'initial'"></discord-message-preview>
            </div>
        </div>
    </section>
</template>
