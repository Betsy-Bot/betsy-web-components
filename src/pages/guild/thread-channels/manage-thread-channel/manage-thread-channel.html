<template>
    <confirmation-dialog
        cancel-text="Cancel"
        confirm-text="Delete"
        dialog.two-way="confirmDeleteDialog"
        handler.bind="(event) => deleteThreadChannel(event)"
        title="Are you sure you would like to delete?"
    >
        This is a permanent action and cannot be undone
    </confirmation-dialog>

    <section id="create-data-command">
        <div class="row">
            <div class="col-12 col-lg-8">
                <feature-header
                    doc-url="https://docs.betsybot.xyz/features/polls"
                    title="${isNew ? 'Create' : 'Edit'} Thread Channel"
                    subtitle="Manage your thread channel to help organize your server channels."
                ></feature-header>
                <div class="text-end my-4">
                    <moo-button class="button-secondary" click.bind="() => confirmDeleteDialog.open()" if.bind="!isNew">
                        Delete Thread Channel
                    </moo-button>
                </div>
                <moo-switch
                    class="mt-3"
                    value.bind="threadChannel.active"
                ></moo-switch>
                <label class="me-5 mb-3">Active?</label>

                <moo-tab-bar>
                    <moo-tab
                        label="Settings"
                        tab.bind="tab"
                        value="settings"
                        active.bind="true"
                    ></moo-tab>
                    <moo-tab
                        label="Roles"
                        value="initial-message"
                        tab.bind="tab"
                    ></moo-tab>
                </moo-tab-bar>

                <form submit.trigger="save()">
                    <div if.bind="tab === 'settings'">
                        <div class="mt-3 mb-2">
                            <discord-channel-selector
                                required.bind="true"
                                label="Channel"
                                channel-id.two-way="threadChannel.discordChannelId"
                            ></discord-channel-selector>
                        </div>
                        <div class="text-end">
                            <moo-button variant="primary" click.trigger="tab = 'initial-message'" type="button">
                                Next
                            </moo-button>
                        </div>
                    </div>
                    <div class="" if.bind="tab === 'initial-message'">
                        <discord-message-creator
                            allow-components="true"
                            message.two-way="threadChannel.initialMessage.message"
                        ></discord-message-creator>

                        <div class="text-end mt-3">
                            <moo-button variant="primary" type="submit">
                                Save
                            </moo-button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-12 col-lg-4">
                <discord-message-preview message.two-way="threadChannel.initialMessage.message"></discord-message-preview>
            </div>
        </div>
    </section>
</template>
